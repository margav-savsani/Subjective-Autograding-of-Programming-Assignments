I assumed that when there is a cycle, all nodes will be backtracked